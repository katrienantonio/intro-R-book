<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Visualizing data in R | Data science in insurance: an R intro</title>
  <meta name="description" content="An open-source and fully-reproducible electronic textbook introducing the use of R to actuarial students and professionals." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Visualizing data in R | Data science in insurance: an R intro" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="An open-source and fully-reproducible electronic textbook introducing the use of R to actuarial students and professionals." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Visualizing data in R | Data science in insurance: an R intro" />
  
  <meta name="twitter:description" content="An open-source and fully-reproducible electronic textbook introducing the use of R to actuarial students and professionals." />
  

<meta name="author" content="Chester Ismay and Albert Y. Kim and Katrien Antonio and Bavo DC Campo" />


<meta name="date" content="2020-11-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="started-with-data.html"/>
<link rel="next" href="data-wrangling.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#subsec:learning-goals"><i class="fa fa-check"></i><b>1.1</b> Learning outcomes</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#subsec:pipeline"><i class="fa fa-check"></i><b>1.2</b> Data/science pipeline</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#inspirations-and-references"><i class="fa fa-check"></i><b>1.3</b> Inspirations and references</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#sec:about-book"><i class="fa fa-check"></i><b>1.4</b> About this book</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>2</b> Getting started in R</a><ul>
<li class="chapter" data-level="2.1" data-path="getting-started.html"><a href="getting-started.html#some-history"><i class="fa fa-check"></i><b>2.1</b> Some history</a></li>
<li class="chapter" data-level="2.2" data-path="getting-started.html"><a href="getting-started.html#what-are-r-and-rstudio"><i class="fa fa-check"></i><b>2.2</b> What are R and RStudio?</a><ul>
<li class="chapter" data-level="2.2.1" data-path="getting-started.html"><a href="getting-started.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>2.2.1</b> Installing R and RStudio</a></li>
<li class="chapter" data-level="2.2.2" data-path="getting-started.html"><a href="getting-started.html#using-r-via-rstudio"><i class="fa fa-check"></i><b>2.2.2</b> Using R via RStudio</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="getting-started.html"><a href="getting-started.html#code"><i class="fa fa-check"></i><b>2.3</b> How do I code in R?</a><ul>
<li class="chapter" data-level="2.3.1" data-path="getting-started.html"><a href="getting-started.html#tips-on-learning-to-code"><i class="fa fa-check"></i><b>2.3.1</b> Tips on learning to code</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="getting-started.html"><a href="getting-started.html#packages"><i class="fa fa-check"></i><b>2.4</b> What are R packages?</a><ul>
<li class="chapter" data-level="2.4.1" data-path="getting-started.html"><a href="getting-started.html#package-installation"><i class="fa fa-check"></i><b>2.4.1</b> Package installation</a></li>
<li class="chapter" data-level="2.4.2" data-path="getting-started.html"><a href="getting-started.html#package-loading"><i class="fa fa-check"></i><b>2.4.2</b> Package loading</a></li>
<li class="chapter" data-level="2.4.3" data-path="getting-started.html"><a href="getting-started.html#packages-on-cran"><i class="fa fa-check"></i><b>2.4.3</b> Packages on CRAN</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="getting-started.html"><a href="getting-started.html#conclusion"><i class="fa fa-check"></i><b>2.5</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="objects-data-types.html"><a href="objects-data-types.html"><i class="fa fa-check"></i><b>3</b> Objects and data types in R</a><ul>
<li class="chapter" data-level="3.1" data-path="objects-data-types.html"><a href="objects-data-types.html#how-it-works"><i class="fa fa-check"></i><b>3.1</b> How it works</a></li>
<li class="chapter" data-level="3.2" data-path="objects-data-types.html"><a href="objects-data-types.html#subsec:Objects"><i class="fa fa-check"></i><b>3.2</b> Objects</a></li>
<li class="chapter" data-level="3.3" data-path="objects-data-types.html"><a href="objects-data-types.html#everything-is-an-object"><i class="fa fa-check"></i><b>3.3</b> Everything is an object</a></li>
<li class="chapter" data-level="3.4" data-path="objects-data-types.html"><a href="objects-data-types.html#basic-data-types"><i class="fa fa-check"></i><b>3.4</b> Basic data types</a></li>
<li class="chapter" data-level="3.5" data-path="objects-data-types.html"><a href="objects-data-types.html#vectors"><i class="fa fa-check"></i><b>3.5</b> Vectors</a><ul>
<li class="chapter" data-level="3.5.1" data-path="objects-data-types.html"><a href="objects-data-types.html#vector-indexing"><i class="fa fa-check"></i><b>3.5.1</b> Vector indexing</a></li>
<li class="chapter" data-level="3.5.2" data-path="objects-data-types.html"><a href="objects-data-types.html#character-and-logical-vectors"><i class="fa fa-check"></i><b>3.5.2</b> Character and logical vectors</a></li>
<li class="chapter" data-level="3.5.3" data-path="objects-data-types.html"><a href="objects-data-types.html#missing-values"><i class="fa fa-check"></i><b>3.5.3</b> Missing values</a></li>
<li class="chapter" data-level="3.5.4" data-path="objects-data-types.html"><a href="objects-data-types.html#logical-operators"><i class="fa fa-check"></i><b>3.5.4</b> Logical operators</a></li>
<li class="chapter" data-level="3.5.5" data-path="objects-data-types.html"><a href="objects-data-types.html#factors"><i class="fa fa-check"></i><b>3.5.5</b> Factors</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="objects-data-types.html"><a href="objects-data-types.html#matrices"><i class="fa fa-check"></i><b>3.6</b> Matrices</a><ul>
<li class="chapter" data-level="3.6.1" data-path="objects-data-types.html"><a href="objects-data-types.html#matrix-operations-and-indexing"><i class="fa fa-check"></i><b>3.6.1</b> Matrix operations and indexing</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="objects-data-types.html"><a href="objects-data-types.html#lists"><i class="fa fa-check"></i><b>3.7</b> Lists</a></li>
<li class="chapter" data-level="3.8" data-path="objects-data-types.html"><a href="objects-data-types.html#data-frames"><i class="fa fa-check"></i><b>3.8</b> Data frames</a></li>
<li class="chapter" data-level="3.9" data-path="objects-data-types.html"><a href="objects-data-types.html#exercises"><i class="fa fa-check"></i><b>3.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="started-with-data.html"><a href="started-with-data.html"><i class="fa fa-check"></i><b>4</b> Getting started with data in R</a><ul>
<li class="chapter" data-level="4.1" data-path="started-with-data.html"><a href="started-with-data.html#importing-data"><i class="fa fa-check"></i><b>4.1</b> Importing data</a><ul>
<li class="chapter" data-level="4.1.1" data-path="started-with-data.html"><a href="started-with-data.html#importing-a-.csv-file-with-read.csv"><i class="fa fa-check"></i><b>4.1.1</b> Importing a .csv file with <code>read.csv()</code></a></li>
<li class="chapter" data-level="4.1.2" data-path="started-with-data.html"><a href="started-with-data.html#importing-a-.txt-file-the-danish-fire-insurance-data"><i class="fa fa-check"></i><b>4.1.2</b> Importing a .txt file: the Danish fire insurance data</a></li>
<li class="chapter" data-level="4.1.3" data-path="started-with-data.html"><a href="started-with-data.html#importing-a-.sas7bdat-file"><i class="fa fa-check"></i><b>4.1.3</b> Importing a .sas7bdat file</a></li>
<li class="chapter" data-level="4.1.4" data-path="started-with-data.html"><a href="started-with-data.html#importing-an-.xlsx-file"><i class="fa fa-check"></i><b>4.1.4</b> Importing an .xlsx file</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="started-with-data.html"><a href="started-with-data.html#basic-data-handling-steps"><i class="fa fa-check"></i><b>4.2</b> Basic data handling steps</a><ul>
<li class="chapter" data-level="4.2.1" data-path="started-with-data.html"><a href="started-with-data.html#subsetting"><i class="fa fa-check"></i><b>4.2.1</b> Subsetting</a></li>
<li class="chapter" data-level="4.2.2" data-path="started-with-data.html"><a href="started-with-data.html#find-minimum-or-maximum"><i class="fa fa-check"></i><b>4.2.2</b> Find minimum or maximum</a></li>
<li class="chapter" data-level="4.2.3" data-path="started-with-data.html"><a href="started-with-data.html#sorting"><i class="fa fa-check"></i><b>4.2.3</b> Sorting</a></li>
<li class="chapter" data-level="4.2.4" data-path="started-with-data.html"><a href="started-with-data.html#merging"><i class="fa fa-check"></i><b>4.2.4</b> Merging</a></li>
<li class="chapter" data-level="4.2.5" data-path="started-with-data.html"><a href="started-with-data.html#aggregate"><i class="fa fa-check"></i><b>4.2.5</b> Aggregate</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="started-with-data.html"><a href="started-with-data.html#exploratory-data-analysis-eda"><i class="fa fa-check"></i><b>4.3</b> Exploratory Data Analysis (EDA)</a><ul>
<li class="chapter" data-level="4.3.1" data-path="started-with-data.html"><a href="started-with-data.html#exploring-a-numerical-variable"><i class="fa fa-check"></i><b>4.3.1</b> Exploring a numerical variable</a></li>
<li class="chapter" data-level="4.3.2" data-path="started-with-data.html"><a href="started-with-data.html#exploring-a-categorical-or-factor-variable"><i class="fa fa-check"></i><b>4.3.2</b> Exploring a categorical (or: factor) variable</a></li>
<li class="chapter" data-level="4.3.3" data-path="started-with-data.html"><a href="started-with-data.html#exploring-two-categorical-or-factor-variables"><i class="fa fa-check"></i><b>4.3.3</b> Exploring two categorical (or: factor) variables</a></li>
<li class="chapter" data-level="4.3.4" data-path="started-with-data.html"><a href="started-with-data.html#exploring-one-numerical-and-one-categorical-variable"><i class="fa fa-check"></i><b>4.3.4</b> Exploring one numerical and one categorical variable</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="started-with-data.html"><a href="started-with-data.html#exercises-1"><i class="fa fa-check"></i><b>4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-viz.html"><a href="data-viz.html"><i class="fa fa-check"></i><b>5</b> Visualizing data in R</a><ul>
<li class="chapter" data-level="5.1" data-path="data-viz.html"><a href="data-viz.html#basic-plot-instructions"><i class="fa fa-check"></i><b>5.1</b> Basic plot instructions</a><ul>
<li class="chapter" data-level="5.1.1" data-path="data-viz.html"><a href="data-viz.html#scatterplot"><i class="fa fa-check"></i><b>5.1.1</b> Scatterplot</a></li>
<li class="chapter" data-level="5.1.2" data-path="data-viz.html"><a href="data-viz.html#saving-the-scatterplot-as-a-pdf"><i class="fa fa-check"></i><b>5.1.2</b> Saving the scatterplot as a pdf</a></li>
<li class="chapter" data-level="5.1.3" data-path="data-viz.html"><a href="data-viz.html#the-curve-function"><i class="fa fa-check"></i><b>5.1.3</b> The <code>curve()</code> function</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="data-viz.html"><a href="data-viz.html#more-fancy-plots"><i class="fa fa-check"></i><b>5.2</b> More fancy plots</a><ul>
<li class="chapter" data-level="5.2.1" data-path="data-viz.html"><a href="data-viz.html#creating-graphics-with-ggplot2"><i class="fa fa-check"></i><b>5.2.1</b> Creating graphics with <code>ggplot2</code></a></li>
<li class="chapter" data-level="5.2.2" data-path="data-viz.html"><a href="data-viz.html#fancy-correlation-plots"><i class="fa fa-check"></i><b>5.2.2</b> Fancy correlation plots</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="data-viz.html"><a href="data-viz.html#exercises-2"><i class="fa fa-check"></i><b>5.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>6</b> Data wrangling in R</a><ul>
<li class="chapter" data-level="6.1" data-path="data-wrangling.html"><a href="data-wrangling.html#ideas-from-the-tidyverse"><i class="fa fa-check"></i><b>6.1</b> Ideas from the <code>tidyverse</code></a><ul>
<li class="chapter" data-level="6.1.1" data-path="data-wrangling.html"><a href="data-wrangling.html#a-tibble-instead-of-a-data.frame"><i class="fa fa-check"></i><b>6.1.1</b> A <code>tibble</code> instead of a <code>data.frame</code></a></li>
<li class="chapter" data-level="6.1.2" data-path="data-wrangling.html"><a href="data-wrangling.html#pipes-in-r"><i class="fa fa-check"></i><b>6.1.2</b> Pipes in R</a></li>
<li class="chapter" data-level="6.1.3" data-path="data-wrangling.html"><a href="data-wrangling.html#filter-observations-using-filter"><i class="fa fa-check"></i><b>6.1.3</b> Filter observations using <code>filter</code></a></li>
<li class="chapter" data-level="6.1.4" data-path="data-wrangling.html"><a href="data-wrangling.html#summarize-variables-using-summarize"><i class="fa fa-check"></i><b>6.1.4</b> Summarize variables using <code>summarize</code></a></li>
<li class="chapter" data-level="6.1.5" data-path="data-wrangling.html"><a href="data-wrangling.html#summarize-based-on-groupings-of-another-variable"><i class="fa fa-check"></i><b>6.1.5</b> Summarize based on groupings of another variable</a></li>
<li class="chapter" data-level="6.1.6" data-path="data-wrangling.html"><a href="data-wrangling.html#joining-tibbles"><i class="fa fa-check"></i><b>6.1.6</b> Joining tibbles</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="data-wrangling.html"><a href="data-wrangling.html#data-science-the-data.table-way"><i class="fa fa-check"></i><b>6.2</b> Data science the <code>data.table</code> way</a><ul>
<li class="chapter" data-level="6.2.1" data-path="data-wrangling.html"><a href="data-wrangling.html#speed-junkies-love-data.table"><i class="fa fa-check"></i><b>6.2.1</b> Speed junkies love <code>data.table</code></a></li>
<li class="chapter" data-level="6.2.2" data-path="data-wrangling.html"><a href="data-wrangling.html#what-is-a-data.table"><i class="fa fa-check"></i><b>6.2.2</b> What is a <code>data.table</code>?</a></li>
<li class="chapter" data-level="6.2.3" data-path="data-wrangling.html"><a href="data-wrangling.html#identify-keys"><i class="fa fa-check"></i><b>6.2.3</b> Identify keys</a></li>
<li class="chapter" data-level="6.2.4" data-path="data-wrangling.html"><a href="data-wrangling.html#alternative-and-faster-ways-to-aggregate"><i class="fa fa-check"></i><b>6.2.4</b> Alternative and faster ways to <code>aggregate</code></a></li>
<li class="chapter" data-level="6.2.5" data-path="data-wrangling.html"><a href="data-wrangling.html#joining-data.tables"><i class="fa fa-check"></i><b>6.2.5</b> Joining <code>data.tables</code></a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="data-wrangling.html"><a href="data-wrangling.html#exercises-3"><i class="fa fa-check"></i><b>6.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="probs.html"><a href="probs.html"><i class="fa fa-check"></i><b>7</b> Working with probability distributions in R</a><ul>
<li class="chapter" data-level="7.1" data-path="probs.html"><a href="probs.html#discrete-distributions"><i class="fa fa-check"></i><b>7.1</b> Discrete distributions</a><ul>
<li class="chapter" data-level="7.1.1" data-path="probs.html"><a href="probs.html#the-binomial-distribution"><i class="fa fa-check"></i><b>7.1.1</b> The binomial distribution</a></li>
<li class="chapter" data-level="7.1.2" data-path="probs.html"><a href="probs.html#the-poisson-distribution"><i class="fa fa-check"></i><b>7.1.2</b> The Poisson distribution</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="probs.html"><a href="probs.html#continuous-distributions"><i class="fa fa-check"></i><b>7.2</b> Continuous distributions</a><ul>
<li class="chapter" data-level="7.2.1" data-path="probs.html"><a href="probs.html#the-normal-distribution"><i class="fa fa-check"></i><b>7.2.1</b> The normal distribution</a></li>
<li class="chapter" data-level="7.2.2" data-path="probs.html"><a href="probs.html#the-gamma-distribution"><i class="fa fa-check"></i><b>7.2.2</b> The gamma distribution</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="probs.html"><a href="probs.html#exercises-4"><i class="fa fa-check"></i><b>7.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>8</b> Writing functions in R</a><ul>
<li class="chapter" data-level="8.1" data-path="functions.html"><a href="functions.html#conditionals-and-control-flow"><i class="fa fa-check"></i><b>8.1</b> Conditionals and control flow</a></li>
<li class="chapter" data-level="8.2" data-path="functions.html"><a href="functions.html#logical-operators-1"><i class="fa fa-check"></i><b>8.2</b> Logical operators</a></li>
<li class="chapter" data-level="8.3" data-path="functions.html"><a href="functions.html#conditional-statements"><i class="fa fa-check"></i><b>8.3</b> Conditional statements</a></li>
<li class="chapter" data-level="8.4" data-path="functions.html"><a href="functions.html#loops"><i class="fa fa-check"></i><b>8.4</b> Loops</a><ul>
<li class="chapter" data-level="8.4.1" data-path="functions.html"><a href="functions.html#the-for-loop"><i class="fa fa-check"></i><b>8.4.1</b> The for loop</a></li>
<li class="chapter" data-level="8.4.2" data-path="functions.html"><a href="functions.html#the-while-loop"><i class="fa fa-check"></i><b>8.4.2</b> The while loop</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="functions.html"><a href="functions.html#functions-in-r"><i class="fa fa-check"></i><b>8.5</b> Functions in R</a><ul>
<li class="chapter" data-level="8.5.1" data-path="functions.html"><a href="functions.html#using-a-function"><i class="fa fa-check"></i><b>8.5.1</b> Using a function</a></li>
<li class="chapter" data-level="8.5.2" data-path="functions.html"><a href="functions.html#write-your-own-function"><i class="fa fa-check"></i><b>8.5.2</b> Write your own function</a></li>
<li class="chapter" data-level="8.5.3" data-path="functions.html"><a href="functions.html#the-argument"><i class="fa fa-check"></i><b>8.5.3</b> The ‘…’ argument</a></li>
<li class="chapter" data-level="8.5.4" data-path="functions.html"><a href="functions.html#function-environments-advanced"><i class="fa fa-check"></i><b>8.5.4</b> Function environments (advanced)</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="functions.html"><a href="functions.html#the-apply-family"><i class="fa fa-check"></i><b>8.6</b> The apply family</a></li>
<li class="chapter" data-level="8.7" data-path="functions.html"><a href="functions.html#exercises-5"><i class="fa fa-check"></i><b>8.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>9</b> Optimization in R</a><ul>
<li class="chapter" data-level="9.1" data-path="optimization.html"><a href="optimization.html#find-the-root-of-a-function"><i class="fa fa-check"></i><b>9.1</b> Find the root of a function</a></li>
<li class="chapter" data-level="9.2" data-path="optimization.html"><a href="optimization.html#find-the-maximum-of-a-function"><i class="fa fa-check"></i><b>9.2</b> Find the maximum of a function</a></li>
<li class="chapter" data-level="9.3" data-path="optimization.html"><a href="optimization.html#do-maximum-likelihood-estimation-mle"><i class="fa fa-check"></i><b>9.3</b> Do Maximum Likelihood Estimation (MLE)</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="lms.html"><a href="lms.html"><i class="fa fa-check"></i><b>10</b> Linear Regression Models in R</a><ul>
<li class="chapter" data-level="10.1" data-path="lms.html"><a href="lms.html#a-simple-linear-regression-model"><i class="fa fa-check"></i><b>10.1</b> A simple linear regression model</a></li>
<li class="chapter" data-level="10.2" data-path="lms.html"><a href="lms.html#a-multiple-linear-regression-model"><i class="fa fa-check"></i><b>10.2</b> A multiple linear regression model</a></li>
<li class="chapter" data-level="10.3" data-path="lms.html"><a href="lms.html#exercises-6"><i class="fa fa-check"></i><b>10.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="glms.html"><a href="glms.html"><i class="fa fa-check"></i><b>11</b> Generalized Linear Models in R</a><ul>
<li class="chapter" data-level="11.1" data-path="glms.html"><a href="glms.html#modelling-count-data-with-poisson-regression-models"><i class="fa fa-check"></i><b>11.1</b> Modelling count data with Poisson regression models</a><ul>
<li class="chapter" data-level="11.1.1" data-path="glms.html"><a href="glms.html#a-first-data-set"><i class="fa fa-check"></i><b>11.1.1</b> A first data set</a></li>
<li class="chapter" data-level="11.1.2" data-path="glms.html"><a href="glms.html#fit-a-poisson-glm"><i class="fa fa-check"></i><b>11.1.2</b> Fit a Poisson GLM</a></li>
<li class="chapter" data-level="11.1.3" data-path="glms.html"><a href="glms.html#the-use-of-exposure"><i class="fa fa-check"></i><b>11.1.3</b> The use of exposure</a></li>
<li class="chapter" data-level="11.1.4" data-path="glms.html"><a href="glms.html#analysis-of-deviance-for-glms"><i class="fa fa-check"></i><b>11.1.4</b> Analysis of deviance for GLMs</a></li>
<li class="chapter" data-level="11.1.5" data-path="glms.html"><a href="glms.html#an-example"><i class="fa fa-check"></i><b>11.1.5</b> An example</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="glms.html"><a href="glms.html#overdispersed-poisson-regression"><i class="fa fa-check"></i><b>11.2</b> Overdispersed Poisson regression</a></li>
<li class="chapter" data-level="11.3" data-path="glms.html"><a href="glms.html#negative-binomial-regression"><i class="fa fa-check"></i><b>11.3</b> Negative Binomial regression</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="biblio.html"><a href="biblio.html"><i class="fa fa-check"></i><b>12</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data science in insurance: an R intro</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-viz" class="section level1">
<h1><span class="header-section-number">5</span> Visualizing data in R</h1>
<p>In this chapter you will learn the basics to build insightful graphics in R.</p>
<div id="basic-plot-instructions" class="section level2">
<h2><span class="header-section-number">5.1</span> Basic plot instructions</h2>
<div id="scatterplot" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Scatterplot</h3>
<p>Your starting point is the construction of a scatterplot. You’ll work with the <code>Journals</code> data from the <code>AER</code> package.</p>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="data-viz.html#cb521-1"></a><span class="co"># load the &#39;Journals&#39; data set in the AER package</span></span>
<span id="cb521-2"><a href="data-viz.html#cb521-2"></a><span class="kw">data</span>(<span class="st">&quot;Journals&quot;</span>)</span>
<span id="cb521-3"><a href="data-viz.html#cb521-3"></a><span class="co"># scan the data</span></span>
<span id="cb521-4"><a href="data-viz.html#cb521-4"></a><span class="kw">head</span>(Journals)</span></code></pre></div>
<pre><code>                                                     title
APEL                     Asian-Pacific Economic Literature
SAJoEH           South African Journal of Economic History
CE                                 Computational Economics
MEPiTE MOCT-MOST Economic Policy in Transitional Economics
JoSE                            Journal of Socio-Economics
LabEc                                     Labour Economics
                    publisher society price pages charpp citations foundingyear
APEL                Blackwell      no   123   440   3822        21         1986
SAJoEH So Afr ec history assn      no    20   309   1782        22         1986
CE                     Kluwer      no   443   567   2924        22         1987
MEPiTE                 Kluwer      no   276   520   3234        22         1991
JoSE                 Elsevier      no   295   791   3024        24         1972
LabEc                Elsevier      no   344   609   2967        24         1994
       subs             field
APEL     14           General
SAJoEH   59  Economic History
CE       17       Specialized
MEPiTE    2      Area Studies
JoSE     96 Interdisciplinary
LabEc    15             Labor</code></pre>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="data-viz.html#cb523-1"></a><span class="kw">names</span>(Journals)</span></code></pre></div>
<pre><code> [1] &quot;title&quot;        &quot;publisher&quot;    &quot;society&quot;      &quot;price&quot;        &quot;pages&quot;       
 [6] &quot;charpp&quot;       &quot;citations&quot;    &quot;foundingyear&quot; &quot;subs&quot;         &quot;field&quot;       </code></pre>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="data-viz.html#cb525-1"></a><span class="co"># e.g. get variable &#39;price&#39; </span></span>
<span id="cb525-2"><a href="data-viz.html#cb525-2"></a>Journals<span class="op">$</span>price</span></code></pre></div>
<pre><code>  [1]  123   20  443  276  295  344   90  242  226  262  279  165  242  905  355
 [16]  375  135  171  284  242  371  115  355  355  835  223  172   62  191  411
 [31]  274  130  100   80  235  392  410  464  650  558  317  495  535  123  717
 [46]  481   54  379  168   82  355   95  240  448  255  448  392  475   85  108
 [61]  394  336  565  255  165   99  203  318  476  473  186  170  824  805  132
 [76]   50  424  130   90  805   96  448  130  595  474  410  395  437  270  265
 [91]  899  133  262  506 1140  211  799  760  442  296  272   45  614  436  481
[106]   95  357  280  142  710  490  870 1147  743  759   36  224   82  160 1170
[121]   90  742  575  163  175  120  590 2120  205  128 1539  346 1046   97  686
[136]  914   85  206 1154   45 1146   95  138  115  640  122  110  923 1000 1234
[151] 1492  810   90  177   74  113  145  590 1154 1450 1431   47   45   47   81
[166] 1010  334  190  180 1893 1400  301 1339   90  310  226  148  159  178   47</code></pre>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="data-viz.html#cb527-1"></a><span class="kw">summary</span>(Journals<span class="op">$</span>price)</span></code></pre></div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
     20     134     282     418     541    2120 </code></pre>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="data-viz.html#cb529-1"></a><span class="co"># focus on price of journal per citation</span></span>
<span id="cb529-2"><a href="data-viz.html#cb529-2"></a>Journals<span class="op">$</span>citeprice &lt;-<span class="st"> </span>Journals<span class="op">$</span>price<span class="op">/</span>Journals<span class="op">$</span>citations</span></code></pre></div>
<p>In the next block of code, we construct a scatterplot of the number of subscriptions versus the price per citation.</p>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="data-viz.html#cb530-1"></a><span class="kw">with</span>(Journals, <span class="kw">plot</span>(<span class="kw">log</span>(subs), <span class="kw">log</span>(citeprice)))</span>
<span id="cb530-2"><a href="data-viz.html#cb530-2"></a><span class="kw">with</span>(Journals, <span class="kw">rug</span>(<span class="kw">log</span>(subs)))  <span class="co"># adds ticks, thus visualizing the marginal distributions of</span></span>
<span id="cb530-3"><a href="data-viz.html#cb530-3"></a>            <span class="co"># the variables, along one or both axes of an existing plot.        </span></span>
<span id="cb530-4"><a href="data-viz.html#cb530-4"></a><span class="kw">with</span>(Journals, <span class="kw">rug</span>(<span class="kw">log</span>(citeprice), <span class="dt">side =</span> <span class="dv">2</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-119-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="data-viz.html#cb531-1"></a><span class="co"># avoid &quot;attach()&quot; and &quot;detach()&quot;</span></span>
<span id="cb531-2"><a href="data-viz.html#cb531-2"></a><span class="kw">plot</span>(<span class="kw">log</span>(subs) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(citeprice), <span class="dt">data =</span> Journals)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-119-2.png" width="576" style="display: block; margin: auto;" /></p>
<p>R has many plotting options that allow you to flex a graph. For example, <code>pch</code> for the plotting character, <code>col</code> for the color of the plotting characters, <code>xlim</code> and <code>ylim</code> to adjust the limits on the x- and y-axis of the scatterplot. To add a legend, you can use the <code>legend()</code> function.</p>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="data-viz.html#cb532-1"></a><span class="kw">plot</span>(</span>
<span id="cb532-2"><a href="data-viz.html#cb532-2"></a>  <span class="kw">log</span>(citeprice) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(subs),</span>
<span id="cb532-3"><a href="data-viz.html#cb532-3"></a>  <span class="dt">data =</span> Journals,</span>
<span id="cb532-4"><a href="data-viz.html#cb532-4"></a>  <span class="dt">pch =</span> <span class="dv">19</span>,</span>
<span id="cb532-5"><a href="data-viz.html#cb532-5"></a>  <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb532-6"><a href="data-viz.html#cb532-6"></a>  <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">8</span>),</span>
<span id="cb532-7"><a href="data-viz.html#cb532-7"></a>  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">7</span>, <span class="dv">4</span>),</span>
<span id="cb532-8"><a href="data-viz.html#cb532-8"></a>  <span class="dt">main =</span> <span class="st">&quot;Library subscriptions&quot;</span></span>
<span id="cb532-9"><a href="data-viz.html#cb532-9"></a>)</span>
<span id="cb532-10"><a href="data-viz.html#cb532-10"></a><span class="kw">rug</span>(<span class="kw">log</span>(Journals<span class="op">$</span>subs))</span>
<span id="cb532-11"><a href="data-viz.html#cb532-11"></a><span class="kw">rug</span>(<span class="kw">log</span>(Journals<span class="op">$</span>citeprice), <span class="dt">side =</span> <span class="dv">2</span>)</span>
<span id="cb532-12"><a href="data-viz.html#cb532-12"></a><span class="co"># subset data, look at journal entitled &quot;Econometrica&quot;</span></span>
<span id="cb532-13"><a href="data-viz.html#cb532-13"></a>journal &lt;-<span class="st"> &quot;Econometrica&quot;</span></span>
<span id="cb532-14"><a href="data-viz.html#cb532-14"></a>journal_info &lt;-<span class="st"> </span><span class="kw">subset</span>(Journals, title <span class="op">==</span><span class="st"> </span>journal)</span>
<span id="cb532-15"><a href="data-viz.html#cb532-15"></a>x.val &lt;-<span class="st"> </span><span class="kw">log</span>(journal_info<span class="op">$</span>subs)</span>
<span id="cb532-16"><a href="data-viz.html#cb532-16"></a>y.val &lt;-<span class="st"> </span><span class="kw">log</span>(journal_info<span class="op">$</span>citeprice)</span>
<span id="cb532-17"><a href="data-viz.html#cb532-17"></a><span class="kw">text</span>(x.val, y.val, journal, <span class="dt">pos =</span> <span class="dv">2</span>)</span>
<span id="cb532-18"><a href="data-viz.html#cb532-18"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="st">&quot;Individual observations&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">pch =</span> <span class="dv">19</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-120-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>You can even use your own images as plotting characters! In case you want to find out how you do this, just go to <a href="http://www.statisticstoproveanything.com/2013/09/using-custom-images-as-pch-values-in-r.html" class="uri">http://www.statisticstoproveanything.com/2013/09/using-custom-images-as-pch-values-in-r.html</a>
<img src="images/PlotCars.png" /></p>
</div>
<div id="saving-the-scatterplot-as-a-pdf" class="section level3">
<h3><span class="header-section-number">5.1.2</span> Saving the scatterplot as a pdf</h3>
<p>It is often very useful to directly store your customized graph as a pdf (with appropriate dimensions) in a particular directory on your machine. Next to saving a plot as pdf, you can also bmp, jpeg, png and so on (see <code>?png</code>).</p>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="data-viz.html#cb533-1"></a>path &lt;-<span class="st"> </span><span class="kw">tempdir</span>()</span>
<span id="cb533-2"><a href="data-viz.html#cb533-2"></a>graph.path &lt;-<span class="st"> </span><span class="kw">file.path</span>(path, <span class="st">&quot;myfile.pdf&quot;</span>)</span>
<span id="cb533-3"><a href="data-viz.html#cb533-3"></a><span class="kw">pdf</span>(graph.path, <span class="dt">height =</span> <span class="dv">5</span>, <span class="dt">width =</span> <span class="dv">6</span>)</span>
<span id="cb533-4"><a href="data-viz.html#cb533-4"></a>    <span class="kw">plot</span>(<span class="kw">log</span>(citeprice)<span class="op">~</span><span class="kw">log</span>(subs), <span class="dt">data =</span> Journals, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">xlim =</span>   </span>
<span id="cb533-5"><a href="data-viz.html#cb533-5"></a>           <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">8</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">7</span>, <span class="dv">4</span>),</span>
<span id="cb533-6"><a href="data-viz.html#cb533-6"></a>    <span class="dt">main =</span> <span class="st">&quot;Library subscriptions&quot;</span>)</span>
<span id="cb533-7"><a href="data-viz.html#cb533-7"></a>    <span class="kw">rug</span>(<span class="kw">log</span>(Journals<span class="op">$</span>subs))</span>
<span id="cb533-8"><a href="data-viz.html#cb533-8"></a>    <span class="kw">rug</span>(<span class="kw">log</span>(Journals<span class="op">$</span>citeprice),<span class="dt">side=</span><span class="dv">2</span>)</span>
<span id="cb533-9"><a href="data-viz.html#cb533-9"></a>    journal &lt;-<span class="st"> &quot;Econometrica&quot;</span></span>
<span id="cb533-10"><a href="data-viz.html#cb533-10"></a>  journal_info &lt;-<span class="st"> </span><span class="kw">subset</span>(Journals, title<span class="op">==</span>journal)</span>
<span id="cb533-11"><a href="data-viz.html#cb533-11"></a>  x.val &lt;-<span class="st"> </span><span class="kw">log</span>(journal_info<span class="op">$</span>subs)</span>
<span id="cb533-12"><a href="data-viz.html#cb533-12"></a>  y.val &lt;-<span class="st"> </span><span class="kw">log</span>(journal_info<span class="op">$</span>citeprice)</span>
<span id="cb533-13"><a href="data-viz.html#cb533-13"></a>  <span class="kw">text</span>(x.val, y.val, journal, <span class="dt">pos=</span><span class="dv">2</span>)</span>
<span id="cb533-14"><a href="data-viz.html#cb533-14"></a><span class="kw">dev.off</span>()</span></code></pre></div>
</div>
<div id="the-curve-function" class="section level3">
<h3><span class="header-section-number">5.1.3</span> The <code>curve()</code> function</h3>
<p>This function draws a curve corresponding to a function over the interval [from, to].</p>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="data-viz.html#cb534-1"></a><span class="kw">curve</span>(dnorm, <span class="dt">from =</span> <span class="dv">-5</span>, <span class="dt">to =</span> <span class="dv">5</span>, <span class="dt">col =</span> <span class="st">&quot;slategray&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">main =</span> <span class="st">&quot;Density of the standard normal distribution&quot;</span>)</span>
<span id="cb534-2"><a href="data-viz.html#cb534-2"></a><span class="kw">text</span>(<span class="op">-</span><span class="dv">5</span>, <span class="fl">0.3</span>, <span class="kw">expression</span>(<span class="kw">f</span>(x) <span class="op">==</span><span class="st"> </span><span class="kw">frac</span>(<span class="dv">1</span>, sigma <span class="op">~</span><span class="er">~</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)) <span class="op">~</span><span class="er">~</span><span class="st"> </span>e<span class="op">^</span>{<span class="op">-</span><span class="kw">frac</span>((x <span class="op">-</span><span class="st"> </span>mu)<span class="op">^</span><span class="dv">2</span>, <span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>)}), <span class="dt">adj =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-122-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb535-1"><a href="data-viz.html#cb535-1"></a>?plotmath</span></code></pre></div>
<hr />
</div>
</div>
<div id="more-fancy-plots" class="section level2">
<h2><span class="header-section-number">5.2</span> More fancy plots</h2>
<p>R has many dedicated packages for advanced plotting. You will work with two of them in this Section.</p>
<div id="creating-graphics-with-ggplot2" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Creating graphics with <code>ggplot2</code></h3>
<p><code>ggplot2</code> is a package created and maintained by prof. Hadley Wickham, it’s aim is to Create Elegant Data Visualisations Using the Grammar of Graphics. Here is the basic explanation of how <code>ggplot2</code> works from <span class="citation">(Grolemund and Wickham 2016)</span>.</p>
<p>With <code>ggplot2</code>, you begin a plot with the function <code>ggplot()</code>. <code>ggplot()</code> creates a coordinate system that you can add layers to. The first argument of <code>ggplot()</code> is the dataset to use in the graph. So <code>ggplot(data = mpg)</code> or <code>ggplot(mpg)</code> creates an empty graph.</p>
<p>You complete your graph by adding one or more layers to <code>ggplot()</code>. The function <code>geom_point()</code> adds a layer of points to your plot, which creates a scatterplot. <code>ggplot2</code> comes with many geom functions that each add a different type of layer to a plot.</p>
<p>Each geom function in <code>ggplot2</code> takes a mapping argument. This defines how variables in your dataset are mapped to visual properties. The mapping argument is always paired with <code>aes()</code>, and the <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> arguments of <code>aes()</code> specify which variables to map to the <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> axes. <code>ggplot2</code> looks for the mapped variable in the data argument, in this case, <code>mpg</code>.</p>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="data-viz.html#cb536-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb536-2"><a href="data-viz.html#cb536-2"></a></span>
<span id="cb536-3"><a href="data-viz.html#cb536-3"></a><span class="co"># use default theme</span></span>
<span id="cb536-4"><a href="data-viz.html#cb536-4"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mtcars, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> hp, <span class="dt">y =</span> mpg)) <span class="op">+</span></span>
<span id="cb536-5"><a href="data-viz.html#cb536-5"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape=</span><span class="dv">1</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">+</span></span>
<span id="cb536-6"><a href="data-viz.html#cb536-6"></a><span class="st">  </span><span class="kw">geom_smooth</span>() </span></code></pre></div>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-123-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb538-1"><a href="data-viz.html#cb538-1"></a><span class="co"># shorter</span></span>
<span id="cb538-2"><a href="data-viz.html#cb538-2"></a><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> hp, <span class="dt">y =</span> mpg)) <span class="op">+</span></span>
<span id="cb538-3"><a href="data-viz.html#cb538-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape=</span><span class="dv">1</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">+</span></span>
<span id="cb538-4"><a href="data-viz.html#cb538-4"></a><span class="st">  </span><span class="kw">geom_smooth</span>() </span></code></pre></div>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-123-2.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb540-1"><a href="data-viz.html#cb540-1"></a><span class="co"># use black and white lay-out</span></span>
<span id="cb540-2"><a href="data-viz.html#cb540-2"></a><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> hp, <span class="dt">y =</span> mpg)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb540-3"><a href="data-viz.html#cb540-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape=</span><span class="dv">1</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">+</span><span class="st"> </span></span>
<span id="cb540-4"><a href="data-viz.html#cb540-4"></a><span class="st">  </span><span class="kw">geom_smooth</span>() </span></code></pre></div>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-123-3.png" width="576" style="display: block; margin: auto;" /></p>
<p>You can add a third variable to a two dimensional scatterplot by mapping it to an aesthetic. An aesthetic is a visual property of the objects in your plot. Aesthetics include things like the size, the shape, or the color of your points. You can display a point in different ways by changing the values of its aesthetic properties.</p>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb542-1"><a href="data-viz.html#cb542-1"></a><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> hp, <span class="dt">y =</span> mpg))<span class="op">+</span></span>
<span id="cb542-2"><a href="data-viz.html#cb542-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">color =</span> gear))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-124-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Or you could have mapped this variable to the alpha aesthetic, which controls the transparency of the points, or the shape of the points.</p>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="data-viz.html#cb543-1"></a><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> hp, <span class="dt">y =</span> mpg))<span class="op">+</span></span>
<span id="cb543-2"><a href="data-viz.html#cb543-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">alpha =</span> gear))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-125-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="data-viz.html#cb544-1"></a><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> hp, <span class="dt">y =</span> mpg))<span class="op">+</span></span>
<span id="cb544-2"><a href="data-viz.html#cb544-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">size =</span> gear))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-125-2.png" width="576" style="display: block; margin: auto;" /></p>
<p>You’ll now construct a boxplot of <code>mpg</code> per <code>cyl</code> using <code>ggplot()</code>.</p>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="data-viz.html#cb545-1"></a><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="kw">factor</span>(cyl), mpg))<span class="op">+</span></span>
<span id="cb545-2"><a href="data-viz.html#cb545-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_jitter</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-126-1.png" width="576" style="display: block; margin: auto;" />
Another way to code the same example</p>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="data-viz.html#cb546-1"></a>p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="kw">factor</span>(cyl), mpg))</span>
<span id="cb546-2"><a href="data-viz.html#cb546-2"></a>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_jitter</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-127-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="fancy-correlation-plots" class="section level3">
<h3><span class="header-section-number">5.2.2</span> Fancy correlation plots</h3>
<p>You use the package <code>corrplot</code> to visualize correlations between variables. For more examples, see <a href="http://cran.r-project.org/web/packages/corrplot/vignettes/corrplot-intro.html">corrplot</a>.</p>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="data-viz.html#cb547-1"></a><span class="kw">library</span>(corrplot)</span></code></pre></div>
<pre><code>corrplot 0.84 loaded</code></pre>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="data-viz.html#cb549-1"></a><span class="co"># get correlation matrix</span></span>
<span id="cb549-2"><a href="data-viz.html#cb549-2"></a>M &lt;-<span class="st"> </span><span class="kw">cor</span>(mtcars)</span>
<span id="cb549-3"><a href="data-viz.html#cb549-3"></a><span class="kw">str</span>(M)</span></code></pre></div>
<pre><code> num [1:11, 1:11] 1 -0.852 -0.848 -0.776 0.681 ...
 - attr(*, &quot;dimnames&quot;)=List of 2
  ..$ : chr [1:11] &quot;mpg&quot; &quot;cyl&quot; &quot;disp&quot; &quot;hp&quot; ...
  ..$ : chr [1:11] &quot;mpg&quot; &quot;cyl&quot; &quot;disp&quot; &quot;hp&quot; ...</code></pre>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="data-viz.html#cb551-1"></a>M</span></code></pre></div>
<pre><code>          mpg      cyl     disp       hp      drat       wt      qsec       vs
mpg   1.00000 -0.85216 -0.84755 -0.77617  0.681172 -0.86766  0.418684  0.66404
cyl  -0.85216  1.00000  0.90203  0.83245 -0.699938  0.78250 -0.591242 -0.81081
disp -0.84755  0.90203  1.00000  0.79095 -0.710214  0.88798 -0.433698 -0.71042
hp   -0.77617  0.83245  0.79095  1.00000 -0.448759  0.65875 -0.708223 -0.72310
drat  0.68117 -0.69994 -0.71021 -0.44876  1.000000 -0.71244  0.091205  0.44028
wt   -0.86766  0.78250  0.88798  0.65875 -0.712441  1.00000 -0.174716 -0.55492
qsec  0.41868 -0.59124 -0.43370 -0.70822  0.091205 -0.17472  1.000000  0.74454
vs    0.66404 -0.81081 -0.71042 -0.72310  0.440278 -0.55492  0.744535  1.00000
am    0.59983 -0.52261 -0.59123 -0.24320  0.712711 -0.69250 -0.229861  0.16835
gear  0.48028 -0.49269 -0.55557 -0.12570  0.699610 -0.58329 -0.212682  0.20602
carb -0.55093  0.52699  0.39498  0.74981 -0.090790  0.42761 -0.656249 -0.56961
            am     gear      carb
mpg   0.599832  0.48028 -0.550925
cyl  -0.522607 -0.49269  0.526988
disp -0.591227 -0.55557  0.394977
hp   -0.243204 -0.12570  0.749812
drat  0.712711  0.69961 -0.090790
wt   -0.692495 -0.58329  0.427606
qsec -0.229861 -0.21268 -0.656249
vs    0.168345  0.20602 -0.569607
am    1.000000  0.79406  0.057534
gear  0.794059  1.00000  0.274073
carb  0.057534  0.27407  1.000000</code></pre>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb553-1"><a href="data-viz.html#cb553-1"></a><span class="co"># visualize the correlation structure</span></span>
<span id="cb553-2"><a href="data-viz.html#cb553-2"></a><span class="kw">corrplot</span>(M, <span class="dt">method =</span> <span class="st">&quot;circle&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-128-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="data-viz.html#cb554-1"></a><span class="kw">corrplot</span>(M, <span class="dt">method =</span> <span class="st">&quot;square&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-128-2.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb555-1"><a href="data-viz.html#cb555-1"></a><span class="kw">corrplot</span>(M, <span class="dt">method =</span> <span class="st">&quot;color&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-128-3.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="data-viz.html#cb556-1"></a><span class="kw">corrplot</span>(M, <span class="dt">type =</span> <span class="st">&quot;upper&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-128-4.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="data-viz.html#cb557-1"></a><span class="kw">corrplot</span>(M, <span class="dt">type =</span> <span class="st">&quot;upper&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;square&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-128-5.png" width="576" style="display: block; margin: auto;" /></p>
<hr />
</div>
</div>
<div id="exercises-2" class="section level2">
<h2><span class="header-section-number">5.3</span> Exercises</h2>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<ol style="list-style-type: decimal">
<li><p>Use the Danish fire insurance losses. Plot the arrival of losses over time. Use <code>type= "l"</code> for a line plot, label the <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>-axis, and give the plot a title using <code>main</code>.</p></li>
<li><p>Do the same with instructions from <code>ggplot2</code>. Get inspiration from <a href="http://r4ds.had.co.nz/data-visualisation.html">R for Data Science</a> and use <code>geom_line()</code> to create the line plot.</p></li>
<li><p>Use the data set ‘car_price.csv’ available in the documentation.</p></li>
</ol>
<ul>
<li>Import the data in R.</li>
<li>Explore the data.</li>
<li>Make a scatterplot of price versus income, use basic plotting instructions and use <code>ggplot2</code>.</li>
<li>Add a smooth line to each of the plots (using <code>lines</code> to add a line to an existing plot and <code>lowess</code> to do scatterplot smoothing and using <code>geom_smooth</code> in the <code>ggplot2</code> grammar).</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>Use the <code>mpg</code> data set. Work through the following steps. The data contains observations collected by the US Environment Protection Agency on 38 models of car.</li>
</ol>
<ul>
<li>Explore the data.</li>
<li>Plot <code>displ</code>, a car’s engine size, in litres on the <span class="math inline">\(x\)</span>-axis and <code>hwy</code>, on the <span class="math inline">\(y\)</span>-axis, that is the car’s fuel efficiency on the highway, in miles per gallon (mpg).</li>
<li>Now do the same but use different colors for the points, based on the <code>class</code> variable in <code>mpg</code>. Add a smooth line.</li>
</ul>
<div class="learncheck">

</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="started-with-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-wrangling.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
